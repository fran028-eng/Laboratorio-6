Comandos utilizados Practica 2 - IP tables - UFW/Firewall-cmd 1pts

#1) Preparación: servicios de prueba (HTTP/FTP/SSH)

sudo apt update
sudo apt install -y nginx vsftpd openssh-server
sudo systemctl enable --now nginx vsftpd ssh
sudo ss -tuln | grep -E ':(80|21|22)\b'


#2) Bloquear puertos con iptables
# BLOQUEAR
sudo iptables -I INPUT -p tcp --dport 80 -j DROP
sudo iptables -I INPUT -p tcp --dport 21 -j DROP
# (Si estás en consola local y quieres bloquear SSH también)
# sudo iptables -I INPUT -p tcp --dport 22 -j DROP

# VER REGLAS APLICADAS
sudo iptables -L INPUT -n --line-numbers

# PRUEBAS RÁPIDAS (desde otra máquina o desde el mismo host contra la IP)
curl -I http://<TU_IP> || true
nc -vz <TU_IP> 21 || true
# nc -vz <TU_IP> 22 || true    # solo si bloqueaste SSH


#3) Permitir nuevamente con iptables (eliminar reglas DROP que agregaste)
sudo iptables -D INPUT -p tcp --dport 80 -j DROP
sudo iptables -D INPUT -p tcp --dport 21 -j DROP
# sudo iptables -D INPUT -p tcp --dport 22 -j DROP   # si lo agregaste

# Verificación
sudo iptables -L INPUT -n --line-numbers
curl -I http://<TU_IP>
nc -vz <TU_IP> 21
# nc -vz <TU_IP> 22


#(Opcional persistir reglas si las necesitas luego)
# sudo apt install -y iptables-persistent
# sudo netfilter-persistent save



#4) Bloquear con UFW (Debian/Parrot)

# Reiniciar UFW a estado limpio (opcional, si ya tenía reglas)
sudo ufw --force reset

# DENY (bloquear)
sudo ufw deny 80/tcp
sudo ufw deny 21/tcp
# sudo ufw deny 22/tcp     # NO si estás por SSH
sudo ufw enable
sudo ufw status verbose

# Pruebas
curl -I http://<TU_IP> || true
nc -vz <TU_IP> 21 || true
# nc -vz <TU_IP> 22 || true


#5) Permitir nuevamente con UFW

sudo ufw allow 80/tcp
sudo ufw allow 21/tcp
# sudo ufw allow 22/tcp
sudo ufw status verbose

# Pruebas
curl -I http://<TU_IP>
nc -vz <TU_IP> 21
# nc -vz <TU_IP> 22










